<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>The shadowy art of classical shadows - Part 1 - My Mind Closet</title><meta name="Description" content="A place where I stow my thoughts on a variety of topics"><meta property="og:title" content="The shadowy art of classical shadows - Part 1" />
<meta property="og:description" content="The shadowy art of classical shadows - Part 1 Recently, I&rsquo;ve become interested in a topic of quantum information science called classical shadows of quantum states. It&rsquo;s a topic that not a lot of people pay attention to since most of the work in quantum is oriented towards devising hybrid quantum-classical algorithms that are of use now. I guess people reading this would be like &ldquo;Pfft, show us a working quantum computer first and then talk about interesting quantum stuff." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-08T14:45:00+00:00" />
<meta property="article:modified_time" content="2024-05-08T14:45:00+00:00" /><meta property="og:site_name" content="My Mind Closet" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The shadowy art of classical shadows - Part 1"/>
<meta name="twitter:description" content="The shadowy art of classical shadows - Part 1 Recently, I&rsquo;ve become interested in a topic of quantum information science called classical shadows of quantum states. It&rsquo;s a topic that not a lot of people pay attention to since most of the work in quantum is oriented towards devising hybrid quantum-classical algorithms that are of use now. I guess people reading this would be like &ldquo;Pfft, show us a working quantum computer first and then talk about interesting quantum stuff."/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/" /><link rel="prev" href="https://aicaffeinelife.github.io/posts/test-post/" /><link rel="next" href="https://aicaffeinelife.github.io/posts/2024_06_07_classical_shadows/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "The shadowy art of classical shadows - Part 1",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/aicaffeinelife.github.io\/posts\/2024_05_08_classical_shadows\/"
        },"genre": "posts","wordcount":  1277 ,
        "url": "https:\/\/aicaffeinelife.github.io\/posts\/2024_05_08_classical_shadows\/","datePublished": "2024-05-08T14:45:00+00:00","dateModified": "2024-05-08T14:45:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Ankit Kulshrestha"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="My Mind Closet">My Mind Closet</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/about"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="My Mind Closet">My Mind Closet</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/about" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">The shadowy art of classical shadows - Part 1</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="akulsh912.com" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Ankit Kulshrestha</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-05-08">2024-05-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1277 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#okay-what-are-classical-shadows">Okay, what are classical shadows?</a></li>
    <li><a href="#along-came-preskill">Along came Preskill</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="the-shadowy-art-of-classical-shadows---part-1">The shadowy art of classical shadows - Part 1</h1>
<p>Recently, I&rsquo;ve become interested in a topic of quantum information science called classical shadows of quantum states. It&rsquo;s a topic that not a lot of people pay attention to since most of the work in quantum is oriented towards devising hybrid quantum-classical algorithms that are of use <em>now</em>.  I guess people reading this would be like &ldquo;Pfft, show us a working quantum computer first and then talk about <em>interesting</em>  quantum stuff. Heh.&rdquo;. I want to assure my skeptical readers though, that this topic is highly relevant to both near and far term applications in quantum computing.</p>
<h2 id="okay-what-are-classical-shadows">Okay, what are classical shadows?</h2>
<p>Imagine, you&rsquo;re traveling along a dark alley and it&rsquo;s raining heavily with flashes of lightning in between. Someone runs towards you and hands you a glowing blue box &ldquo;Hold this! they are coming after me, I can&rsquo;t be found with this!&rdquo;. You may ask &ldquo;What in the world is this?&rdquo; and the stranger replies &ldquo;It&rsquo;s a quantum state, I just don&rsquo;t know how it came to be.&rdquo; You look down at the box and see a glowing $\rho$ symbol on top of the box. Before you can ask the stranger another question, he&rsquo;s vanished in thin air.</p>
<p>Now, you&rsquo;re a curious person and naturally want to know what&rsquo;s inside.  The box however has an ominous warning label &ldquo;DO NOT OPEN. Contents will annihilate upon examination.&rdquo; As you scratch your head about ways to explore the contents without &ldquo;annihilating&rdquo; yourself, you accidentally shine a light on it and see some image projected on the wall opposite you&hellip;.</p>
<p><em>Record scratch</em></p>
<p>Clearly, the story isn&rsquo;t going to satisfy my mathematically oriented readers. So, off to dryland we go.  Imagine you have an unknown quantum state $\rho$ that has been produced by the action of some quantum channel on a $|0\rangle$ state.  Now, quantum states are fragile little creatures since measuring a quantum state collapses it into the outcome state (e.g. if you measure $\rho$ to be $|1\rangle$ then it&rsquo;s going to remain $|1\rangle$ after measurement). If we wanted to know <em>something</em> about the system that produced $\rho$ we will need many copies ($\Omega(D^2)$ for a $D$-dimensional system to be precise). This process is known as <em>quantum state tomography</em>. It&rsquo;s very similar to reconstructing a Mummy from it&rsquo;s tomb without opening the said tomb (you know bad things happen if you open <em>those</em>).</p>
<p>Anyways, <a href="https://arxiv.org/pdf/1711.01053" target="_blank" rel="noopener noreffer ">Aaronson <em>et al.</em></a> came up with this idea that you <em>don&rsquo;t</em> need to reconstruct the full Mummy (erm.. I mean quantum state). It will be sufficient to predict <em>some</em> finite properties of this unknown state and thereby gain a <em>shadow</em> of the unknown quantum state in terms of those finite properties. To be more dry, here&rsquo;s the original definition from their work:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/classical_shadows_p1/shadow_tomography_aaronson.png"
        data-srcset="/classical_shadows_p1/shadow_tomography_aaronson.png, /classical_shadows_p1/shadow_tomography_aaronson.png 1.5x, /classical_shadows_p1/shadow_tomography_aaronson.png 2x"
        data-sizes="auto"
        alt="/classical_shadows_p1/shadow_tomography_aaronson.png"
        title="alt text" /></p>
<p>Here $E_1 \dots E_M$ are measurement outcomes when a quantum state in measured in some basis (this defines a probability distribution over the set of possible outcomes). Their key result is this:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/classical_shadows_p1/aaronson_sample_result.png"
        data-srcset="/classical_shadows_p1/aaronson_sample_result.png, /classical_shadows_p1/aaronson_sample_result.png 1.5x, /classical_shadows_p1/aaronson_sample_result.png 2x"
        data-sizes="auto"
        alt="/classical_shadows_p1/aaronson_sample_result.png"
        title="alt text" /></p>
<p>Essentially, they say we can predict $M$ properties of an unknown quantum state upto an accuracy $\varepsilon$ with at most $k$ copies of $\rho$ bounded by that big $\tilde{O}$ . The bound depends on the number of properties $M$ we want to predict (poly-logarithmically) and <em>logarithmically</em> with the system size $D$.</p>
<p>Now, this seems to be a decent bound since we scale logarithmically with system size, it means we can at least handle sizes of a few 100 qubits. However, one key part that I omitted earlier was that in order to be able to do a shadow tomography we need to store $k$ copies of that state in <em>quantum memory</em>. Going back to our story earlier, it means we&rsquo;ll need to track down our shady quantum state dealer these many times if we want to know what was in the box.</p>
<p><em>Cue sad cello music</em></p>
<h2 id="along-came-preskill">Along came Preskill</h2>
<p>Gondor then seemed to be lost to the dark lord then and all the men were fearing dark times upon them. Then over the horizon, a brilliant flash of light grew and kept on growing &ldquo;Gandalf&hellip;&rdquo; said men with a renewed hope. Well, in this case the brilliant flash of light was <a href="https://arxiv.org/pdf/2002.08953.pdf" target="_blank" rel="noopener noreffer ">a paper</a> by Huang, Preskil <em>et al</em>.</p>
<p>This paper presented a very counterintuitive protocol <em>and</em> showed that their idea wasn&rsquo;t just crazy hand waving that worked for some cases. It had rigorous performance guarantees which were <em>independent</em> of the system size. The idea is this: We take the unknown quantum state $\rho$ and perform a measurement by appending a random unitary $U$ sampled from some ensemble $\mathcal{U}$ and obtaining a bitstring $|b\rangle$ . We repeat this procedure $N$ times and end up having a snapshot of the quantum state in a <em>classical format</em>. This was called a classical shadow of a quantum state and is compactly written as:</p>
<p>$$
S(\rho; N) = [\hat{\rho}_1, \hat{\rho}_2, \dots \hat{\rho}_N]
$$
Where $\hat{\rho} = \mathcal{M}^{-1}(U^\dagger |b\rangle \langle b| U)$ and $|b\rangle \in {0, 1}$ . The justification for doing this is that this shadow describes a quantum channel that should evaluate to the input state $\rho$ <em>in expectation</em>. Here $\mathcal{M}$ describes a quantum channel with a random unitary transformation i.e. $\mathcal{M}(\rho) = E[U^\dagger |b\rangle |b\langle U]$. The &ldquo;in expectation&rdquo; part comes by inverting this channel $\rho = E[\mathcal{M}^{-1}(U^\dagger |b\rangle |b\langle U)]$ . This channel is not a physical channel but nevertheless can be inverted. The authors provide the inverse channel when ensemble $\mathcal{U}$ is either a Clifford group or a Clifford group with only single qubit gates included (equivalent to measuring in Pauli basis).</p>
<p>The protocol prescribed is very simple in practice:</p>
<ul>
<li>We take our unknown quantum state $\rho$ and perform $N$ random rotations and obtain the shadow.</li>
<li>Once obtained, we use this as a proxy for a true quantum state and predict various properties of a quantum system by <em>operating completely in classical space.</em></li>
</ul>
<p>Most of the tomography literature was focused on obtaining a &ldquo;close enough&rdquo; version of an unknown quantum state $\rho$ . The works by Aaronson and this one allowed us to ask more from the shadow we mined in the depths of Minas-Tritnh. For example, we wish to predict various linear properties of the quantum system. Classical shadows enable us to do so, without really caring about the unknown quantum state.  Once we acquire the shadow, we can work completely in <em>classical</em> space and process this information via classical transforms. Let&rsquo;s say we have some quantum observables $O_1, O_2, \dots O_M$ and we want to predict their properties. Assuming we have access to a classical shadow $\hat{\rho} = S(\rho; N)$ we can predict $Tr[O_i\hat{\rho}]$ by using a median-of-means approximation presented in Algorithm 1 of the paper. More importantly, here&rsquo;s the bound on the number of samples required to approximate the expectation values of quantum observables up to a certain accuracy $\epsilon$ :</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/classical_shadows_p1/huang_preskil_sample_result.png"
        data-srcset="/classical_shadows_p1/huang_preskil_sample_result.png, /classical_shadows_p1/huang_preskil_sample_result.png 1.5x, /classical_shadows_p1/huang_preskil_sample_result.png 2x"
        data-sizes="auto"
        alt="/classical_shadows_p1/huang_preskil_sample_result.png"
        title="alt" /></p>
<!-- raw HTML omitted -->
<p>It shows that we only need samples that scale <em>logarithmically</em> with the <em>number of observables</em>. The bound is independent of system size since the $||O||^2_{shadow}$ depends on the  type of ensemble one samples from. If $\mathcal{U} = Cl(2^n)$ (i.e. the clifford group), then the expression after $log(M)$ is upper bounded by operator norm $Tr[O]^2$  and if $\mathcal{U} = Cl(2)^{\otimes n}$ i.e. single qubit cliffords then the expression is upper bounded as $4^{k}||O||^2_{\infty}$ where $k$ is the locality (i.e. number of qubits a particular single qubit gate acts on). Thus, we can reliably predict $M$ properties of quantum observables by simply acquiring a classical representation and computing $Tr[O\hat{\rho}]$ with a finite number of samples.</p>
<p>I&rsquo;ve barely scratched the surface in this blogpost, in the next one, I&rsquo;ll discuss the wonderful applications of these classical shadows beyond what we show today.</p>
<p>Toodles!</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-05-08</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/" data-title="The shadowy art of classical shadows - Part 1" data-via="aicaffeinelife"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/" data-title="The shadowy art of classical shadows - Part 1"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/" data-title="The shadowy art of classical shadows - Part 1"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://aicaffeinelife.github.io/posts/2024_05_08_classical_shadows/" data-title="The shadowy art of classical shadows - Part 1"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/test-post/" class="prev" rel="prev" title="Test Post"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Test Post</a>
            <a href="/posts/2024_06_07_classical_shadows/" class="next" rel="next" title="The shadowy art of classical shadows - Part 2">The shadowy art of classical shadows - Part 2<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.119.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="akulsh912.com" target="_blank">Ankit Kulshrestha</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
